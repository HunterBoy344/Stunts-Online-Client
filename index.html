<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Stunts Online</title>
  <script src="js-dos.js"></script>
  <style>
    html, body, {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #jsdos {
      width: 640px;
      height: 400px;
      text-align:center;
      display: inline;
    }

    #canvas-container {
      width: 100%;
      text-align: center;
    }  

    canvas {
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
    }
  </style>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <p id="warning" style="display: none; text-align: center">WARNING: The round has ended, and the results are final! Please return to the main menu before the track changes in 20 seconds.<br>When the track changes, please load the new track from the Track menu! Results from a prior track will not be counted when the track changes!</p>
  <div class="frameParent">
    <div id="timer"></div>
  </div>
  <div id="canvas-container">
    <canvas id="jsdos"></canvas>
    <div class="frameParent">
      <div id="leaderboard" width="300px" height="150px"></div>
      <div id="chatview" width="300px" height="150px">
        <div id="chatviewUpload">
          <input id=downloadinput type="text" placeholder="Filename to download..."/><button onClick='downloadFile(document.getElementById("downloadinput").value); document.getElementById("downloadinput").value = ""'>Download</button>
          <input id="uploadinput" type="file"/><button onClick='uploadFile()'>Upload</button><br>
          <p>To protect against cheating, these options will be removed when you connect to a server.</p>
        </div>
        <div id="chatviewLogParent" style="display:none">
          <div id="chatviewLog"></div>
          <div id="chatviewBox"><input id="messagebox" type="text"/><button onClick='sendMessage()'>Send</button></div>
        </div>
      </div>
    </div>
  </div>
  <div style="text-align: center">
    Username: <input type="text" id="usernameinput"></input><br>
    Server: <input type="text" id="serverinput"></input><br>
    <button id="connectbutton">Connect</button>
    <button id="connectunsecure">Connect (Unsecure)</button>
  </div>
  <p style="text-align: center">Controls: Arrows = Drive/Move Cursor, ENTER = Select, ESC = Open Menu, C = Change Camera, D = Hide/Show Driver HUD</p>
  <p style="text-align: center">IMPORTANT: Before you race, please load the server track from the Track menu! There should be only one track there, so it's not hard to find.</p>
  <p style="text-align: center">Also, don't worry about copy protection; just press ENTER if you're given a prompt. NeverLock Loader disables copy protection, so you don't have to worry about it.</p>
  <p style="text-align: center">The objective of the game is to set the best time on a track in a limited time frame. Each round has a different track. You'll be competing against other players, so you'll have to beat your own time and others' to remain on top! Good luck!</p>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script src="script.js"></script>
  <script>
    var jsdosfs
    var FS
    Dos(document.getElementById("jsdos"), {
      wdosboxUrl: "/wdosbox.js",
      cycles: 'max',
    }).ready(function (fs, main) {
      jsdosfs = fs
      FS = jsdosfs.fs
      fs.extract("STUNTS-JSDOS.zip").then(function () {
        main(["-c", "STSMP.BAT"]).then(function (ci) {
          window.Module = ci.dos;
          window.ci = ci;
          document.addEventListener("keydown", (event) => {
          if (event.keyCode === 192) {
            ci.simulateKeyPress(27)
            return;
          }
  // do something
});

          //DosController.Qwerty(ci.getParentDiv(), ci.getKeyEventConsumer());
          //DosController.Move(ci.getParentDiv(), ci.getKeyEventConsumer());
        });
      });
    });
  </script>
</body>

</html>
